<title>Sending interactions with a button</title>
<body>
<button onclick="interact()">Interact</button>

<script>
    const testNode = document.createElement('pre')
    document.body.append(testNode);


    (async function () {
        const content = await window.tunnel.getContent()
        testNode.innerText = `This is the current content:\n ${JSON.stringify(content, null, "\t")}`
    })()

    async function interact() {
        let success
        let content
        testNode.innerText = "I am sending an interaction"
        document.body.style.backgroundColor = "orange";

        try {
            const request = window.tunnel.sendInteraction(`[${new Date().toUTCString()}] This is a test interaction`)
            testNode.innerText += "\nFrame sent interaction"
            content = await request
            success = content !== undefined;
            testNode.innerText += "\nThe new content is now:\n" + JSON.stringify(content, null, '\t')
        } catch (e) {
            success = false
        }

        document.body.style.backgroundColor = success ? "lime" : "red";
    }

</script>
</body>